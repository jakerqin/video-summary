# Video Insight - 实现计划

**文档版本：** v1.0
**创建日期：** 2026-02-03
**预计工期：** 4-6 周

---

## 项目概述

本文档描述 Video Insight MVP 版本的实现计划，采用分阶段迭代开发的方式，确保每个阶段都能产出可验证的成果。

---

## 阶段划分

### 阶段 0：项目初始化（1-2 天）

**目标：** 搭建基础项目结构，配置开发环境

**任务清单：**

- [ ] 初始化项目仓库
  - [ ] 创建 Git 仓库
  - [ ] 配置 .gitignore
  - [ ] 创建 README.md
  - [ ] 设置项目目录结构

- [ ] 前端项目初始化
  - [ ] 使用 Vite 创建 Electron + React 项目
  - [ ] 配置 TypeScript
  - [ ] 配置 Tailwind CSS
  - [ ] 安装必要依赖（Zustand、React Router 等）
  - [ ] 配置 Electron Builder

- [ ] 后端项目初始化
  - [ ] 创建 Python 虚拟环境
  - [ ] 安装 FastAPI、uvicorn 等依赖
  - [ ] 配置项目结构
  - [ ] 创建 requirements.txt

- [ ] 开发工具配置
  - [ ] 配置 ESLint、Prettier
  - [ ] 配置 Python Black、Flake8
  - [ ] 配置 VS Code 工作区

**验收标准：**
- 前端项目可以启动并显示 Hello World
- 后端项目可以启动并响应 /health 接口
- 代码格式化工具正常工作

---

### 阶段 1：基础架构搭建（3-5 天）

**目标：** 实现前后端通信、进程管理、基础 UI 框架

**任务清单：**

#### 1.1 Electron 主进程开发

- [ ] 窗口管理
  - [ ] 创建主窗口
  - [ ] 配置窗口大小、最小尺寸
  - [ ] 实现窗口状态保存

- [ ] Python 子进程管理
  - [ ] 实现 Python 后端启动逻辑
  - [ ] 实现进程健康检查
  - [ ] 实现进程优雅关闭
  - [ ] 处理端口冲突

- [ ] IPC 通信
  - [ ] 定义 IPC 通信协议
  - [ ] 实现主进程 IPC 处理器
  - [ ] 实现预加载脚本

#### 1.2 后端基础框架

- [ ] FastAPI 应用搭建
  - [ ] 创建 FastAPI 应用实例
  - [ ] 配置 CORS
  - [ ] 实现健康检查接口
  - [ ] 配置日志系统

- [ ] WebSocket 服务
  - [ ] 实现 WebSocket 连接管理
  - [ ] 实现进度推送机制
  - [ ] 实现心跳检测

- [ ] 配置管理
  - [ ] 实现配置文件加载
  - [ ] 实现配置验证
  - [ ] 实现配置热更新

#### 1.3 前端基础 UI

- [ ] 布局框架
  - [ ] 实现主布局组件
  - [ ] 实现侧边栏（可选）
  - [ ] 实现顶部工具栏

- [ ] 状态管理
  - [ ] 创建 Zustand stores
  - [ ] 实现应用状态管理
  - [ ] 实现队列状态管理
  - [ ] 实现设置状态管理

- [ ] 服务层
  - [ ] 实现 IPC 服务封装
  - [ ] 实现 WebSocket 服务封装
  - [ ] 实现错误处理

**验收标准：**
- Electron 应用可以启动并自动启动 Python 后端
- 前端可以通过 IPC 与主进程通信
- 前端可以通过 WebSocket 与后端通信
- 日志系统正常工作

---

### 阶段 2：视频输入功能（3-4 天）

**目标：** 实现本地文件拖拽和 URL 输入功能

**任务清单：**

#### 2.1 文件拖拽功能

- [ ] DropZone 组件开发
  - [ ] 实现拖拽区域 UI
  - [ ] 实现文件拖拽事件处理
  - [ ] 实现文件格式验证
  - [ ] 实现文件大小检查
  - [ ] 实现多文件支持

- [ ] 文件处理
  - [ ] 实现文件信息提取（时长、大小等）
  - [ ] 实现文件预览（缩略图）
  - [ ] 实现文件列表展示

#### 2.2 URL 输入功能

- [ ] URLInput 组件开发
  - [ ] 实现 URL 输入框 UI
  - [ ] 实现 URL 格式验证
  - [ ] 实现平台识别（小红书）
  - [ ] 实现粘贴快捷键支持

- [ ] 小红书下载器实现
  - [ ] 研究开源项目实现
  - [ ] 实现 URL 解析
  - [ ] 实现视频信息获取
  - [ ] 实现视频下载功能
  - [ ] 实现下载进度反馈

#### 2.3 处理队列

- [ ] ProcessingQueue 组件开发
  - [ ] 实现队列列表 UI
  - [ ] 实现任务状态显示
  - [ ] 实现任务操作（删除、重试）
  - [ ] 实现队列排序

- [ ] 队列管理逻辑
  - [ ] 实现任务添加
  - [ ] 实现任务状态更新
  - [ ] 实现任务持久化（可选）

**验收标准：**
- 可以通过拖拽添加本地视频文件
- 可以通过粘贴小红书链接添加视频
- 视频信息正确显示在队列中
- 小红书视频可以成功下载

---

### 阶段 3：视频处理核心功能（5-7 天）

**目标：** 实现字幕提取、Whisper 识别、文本预处理

**任务清单：**

#### 3.1 字幕提取

- [ ] SubtitleExtractor 实现
  - [ ] 安装和配置 FFmpeg
  - [ ] 实现字幕流检测
  - [ ] 实现字幕提取（SRT/ASS/VTT）
  - [ ] 实现 SRT 解析
  - [ ] 实现文本清洗

- [ ] 测试
  - [ ] 测试不同字幕格式
  - [ ] 测试无字幕视频
  - [ ] 测试多字幕轨道

#### 3.2 Whisper 语音识别

- [ ] WhisperService 实现
  - [ ] 安装 faster-whisper
  - [ ] 下载 Whisper 模型
  - [ ] 实现音频提取
  - [ ] 实现语音识别
  - [ ] 实现进度回调

- [ ] 性能优化
  - [ ] 实现模型缓存
  - [ ] 实现批处理优化
  - [ ] 测试不同模型大小的性能

- [ ] 测试
  - [ ] 测试中文识别准确率
  - [ ] 测试英文识别准确率
  - [ ] 测试长视频处理

#### 3.3 文本预处理

- [ ] 文本清洗
  - [ ] 去除重复内容
  - [ ] 标点符号优化
  - [ ] 分段整理
  - [ ] 去除无意义内容

- [ ] 文本分析
  - [ ] 统计字数
  - [ ] 检测语言
  - [ ] 提取关键词（可选）

#### 3.4 处理管线集成

- [ ] Pipeline 实现
  - [ ] 实现处理流程编排
  - [ ] 实现阶段切换
  - [ ] 实现进度计算
  - [ ] 实现错误处理

- [ ] 进度反馈
  - [ ] 实现 WebSocket 进度推送
  - [ ] 实现前端进度显示
  - [ ] 实现日志输出

**验收标准：**
- 可以成功提取视频字幕
- 无字幕视频可以通过 Whisper 识别
- 识别准确率达到可用水平
- 进度实时反馈到前端

---

### 阶段 4：AI 摘要生成（3-4 天）

**目标：** 实现 MiniMax API 集成和摘要生成

**任务清单：**

#### 4.1 MiniMax API 集成

- [ ] Summarizer 实现
  - [ ] 实现 API 认证
  - [ ] 实现流式请求
  - [ ] 实现错误处理
  - [ ] 实现重试机制

- [ ] Prompt 管理
  - [ ] 实现 Prompt 模板加载
  - [ ] 实现 Prompt 构建
  - [ ] 实现变量替换

- [ ] 测试
  - [ ] 测试 API 连接
  - [ ] 测试不同长度文本
  - [ ] 测试错误场景

#### 4.2 模板系统

- [ ] 预设模板
  - [ ] 设计 5 个预设模板
  - [ ] 实现模板配置文件
  - [ ] 实现模板加载

- [ ] TemplateSelector 组件
  - [ ] 实现模板选择 UI
  - [ ] 实现模板预览
  - [ ] 实现模板切换

#### 4.3 自定义 Prompt 编辑器

- [ ] CustomPromptEditor 组件
  - [ ] 实现 Prompt 编辑器 UI
  - [ ] 实现语法高亮（可选）
  - [ ] 实现变量提示
  - [ ] 实现保存功能

- [ ] 自定义模板管理
  - [ ] 实现模板保存
  - [ ] 实现模板加载
  - [ ] 实现模板删除

**验收标准：**
- 可以成功调用 MiniMax API
- 预设模板可以正常使用
- 可以创建和使用自定义模板
- 摘要质量达到预期

---

### 阶段 5：Markdown 导出（2-3 天）

**目标：** 实现 Markdown 生成和文件导出

**任务清单：**

#### 5.1 Markdown 生成

- [ ] MarkdownGenerator 实现
  - [ ] 实现 Markdown 模板
  - [ ] 实现元数据格式化
  - [ ] 实现内容格式化
  - [ ] 实现文件命名规则

- [ ] 格式优化
  - [ ] 实现标题层级
  - [ ] 实现列表格式
  - [ ] 实现代码块（如有）
  - [ ] 实现链接格式

#### 5.2 文件导出

- [ ] 导出功能
  - [ ] 实现文件保存
  - [ ] 实现目录创建
  - [ ] 实现文件名冲突处理
  - [ ] 实现导出完成通知

- [ ] 文件管理
  - [ ] 实现打开文件所在文件夹
  - [ ] 实现快速预览（可选）
  - [ ] 实现导出历史（可选）

**验收标准：**
- 可以生成格式正确的 Markdown 文件
- 文件保存到指定目录
- 导出完成后有明确提示

---

### 阶段 6：设置和配置（2-3 天）

**目标：** 实现应用设置和用户配置管理

**任务清单：**

#### 6.1 设置面板

- [ ] SettingsPanel 组件
  - [ ] 实现设置面板 UI
  - [ ] 实现 API Key 配置
  - [ ] 实现输出路径配置
  - [ ] 实现 Whisper 模型选择
  - [ ] 实现其他选项

- [ ] 配置验证
  - [ ] 实现 API Key 验证
  - [ ] 实现路径验证
  - [ ] 实现配置保存

#### 6.2 配置持久化

- [ ] 配置存储
  - [ ] 实现配置文件读写
  - [ ] 实现 API Key 加密存储
  - [ ] 实现配置迁移（版本升级）

- [ ] 配置同步
  - [ ] 实现前后端配置同步
  - [ ] 实现配置热更新

**验收标准：**
- 设置可以正常保存和加载
- API Key 安全存储
- 配置修改后立即生效

---

### 阶段 7：错误处理和优化（3-4 天）

**目标：** 完善错误处理、性能优化、用户体验优化

**任务清单：**

#### 7.1 错误处理

- [ ] 前端错误处理
  - [ ] 实现全局错误捕获
  - [ ] 实现错误提示 UI
  - [ ] 实现错误日志记录

- [ ] 后端错误处理
  - [ ] 实现异常捕获
  - [ ] 实现错误分类
  - [ ] 实现错误恢复策略

- [ ] 用户友好提示
  - [ ] 设计错误提示文案
  - [ ] 实现解决方案建议
  - [ ] 实现错误报告（可选）

#### 7.2 性能优化

- [ ] 前端优化
  - [ ] 实现虚拟列表（队列）
  - [ ] 优化渲染性能
  - [ ] 减少不必要的重渲染

- [ ] 后端优化
  - [ ] 优化 Whisper 加载时间
  - [ ] 优化内存使用
  - [ ] 实现资源清理

- [ ] 网络优化
  - [ ] 实现请求缓存
  - [ ] 优化下载速度
  - [ ] 实现断点续传（可选）

#### 7.3 用户体验优化

- [ ] 交互优化
  - [ ] 添加加载动画
  - [ ] 添加操作反馈
  - [ ] 优化快捷键

- [ ] 视觉优化
  - [ ] 统一视觉风格
  - [ ] 优化颜色搭配
  - [ ] 添加图标和插图

**验收标准：**
- 所有错误都有友好提示
- 应用运行流畅，无明显卡顿
- 用户体验良好

---

### 阶段 8：测试和打包（3-5 天）

**目标：** 完成测试、打包、发布准备

**任务清单：**

#### 8.1 测试

- [ ] 单元测试
  - [ ] 编写后端核心模块测试
  - [ ] 编写前端关键组件测试
  - [ ] 达到 80% 覆盖率

- [ ] 集成测试
  - [ ] 测试完整处理流程
  - [ ] 测试各种错误场景
  - [ ] 测试边界情况

- [ ] 用户测试
  - [ ] 邀请用户试用
  - [ ] 收集反馈
  - [ ] 修复问题

#### 8.2 打包和发布

- [ ] 打包配置
  - [ ] 配置 Electron Builder
  - [ ] 打包 Python 后端
  - [ ] 打包 Whisper 模型
  - [ ] 配置应用签名（可选）

- [ ] 打包测试
  - [ ] 测试 DMG 安装
  - [ ] 测试应用启动
  - [ ] 测试所有功能

- [ ] 发布准备
  - [ ] 编写用户文档
  - [ ] 准备发布说明
  - [ ] 准备宣传材料

**验收标准：**
- 所有测试通过
- 打包后的应用可以正常运行
- 文档完整

---

## 里程碑

| 里程碑 | 完成时间 | 交付物 |
|--------|---------|--------|
| M1: 基础架构完成 | Week 1 | 前后端通信正常，基础 UI 完成 |
| M2: 视频输入完成 | Week 2 | 可以添加本地文件和小红书链接 |
| M3: 核心处理完成 | Week 3-4 | 可以完成字幕提取和语音识别 |
| M4: AI 摘要完成 | Week 4-5 | 可以生成高质量摘要 |
| M5: MVP 完成 | Week 6 | 完整功能可用，可以发布 |

---

## 风险管理

### 技术风险

| 风险 | 影响 | 概率 | 缓解措施 |
|------|------|------|---------|
| 小红书反爬策略变化 | 高 | 中 | 参考多个开源项目，保持更新 |
| Whisper 性能不足 | 中 | 低 | 提供模型大小选择，优化算法 |
| MiniMax API 不稳定 | 高 | 低 | 实现重试机制，提供降级方案 |
| 打包体积过大 | 低 | 中 | 优化依赖，按需加载 |

### 进度风险

| 风险 | 影响 | 概率 | 缓解措施 |
|------|------|------|---------|
| 开发时间超预期 | 中 | 中 | 预留缓冲时间，优先核心功能 |
| 测试发现重大问题 | 高 | 低 | 早期测试，持续集成 |
| 第三方依赖问题 | 中 | 低 | 提前验证，准备备选方案 |

---

## 资源需求

### 开发资源

- **开发人员：** 1-2 名全栈工程师
- **测试人员：** 1 名（兼职）
- **设计师：** 1 名（兼职，UI 设计）

### 硬件资源

- **开发机器：** Mac（16GB+ 内存）
- **测试机器：** 不同配置的 Mac（8GB、16GB、32GB）

### 第三方服务

- **MiniMax API：** 预算约 ¥500-1000（测试和开发）
- **域名和服务器：** 可选（如需官网）

---

## 质量标准

### 代码质量

- 代码覆盖率 > 80%
- 无严重 Bug
- 代码符合规范（ESLint、Black）

### 性能标准

- 应用启动时间 < 3 秒
- 10 分钟视频处理时间 < 5 分钟
- 内存占用 < 4GB

### 用户体验标准

- 操作流畅，无明显卡顿
- 错误提示清晰友好
- 界面美观，符合 macOS 设计规范

---

## 后续计划

### V1.1 版本（+2-3 周）

- 自定义 Prompt 编辑器增强
- 批量处理优化
- 性能优化
- Bug 修复

### V1.2 版本（+3-4 周）

- 支持抖音视频
- 支持 B 站视频
- 添加更多预设模板
- 导出格式扩展（PDF、HTML）

### V1.3 版本（+4-6 周）

- 内置知识库管理
- 搜索和标签功能
- 视频片段标注
- 团队协作功能（可选）

---

## 附录

### A. 技术栈清单

**前端：**
- Electron 28+
- React 18+
- TypeScript 5+
- Vite 5+
- Tailwind CSS 3+
- Zustand 4+

**后端：**
- Python 3.10+
- FastAPI 0.109+
- faster-whisper 1.0+
- FFmpeg 6.0+
- httpx 0.26+

**工具：**
- Git
- VS Code
- Postman（API 测试）
- PyInstaller（打包）
- Electron Builder（打包）

### B. 参考资料

- [Electron 文档](https://www.electronjs.org/docs)
- [FastAPI 文档](https://fastapi.tiangolo.com/)
- [Whisper 文档](https://github.com/openai/whisper)
- [MiniMax API 文档](https://www.minimaxi.com/document)
- [小红书下载器参考](https://github.com/hoanx0601/Xiaohongshu_Douyin_downloader_no_watermark)

### C. 开发规范

**Git 提交规范：**
- `feat:` 新功能
- `fix:` Bug 修复
- `docs:` 文档更新
- `style:` 代码格式调整
- `refactor:` 重构
- `test:` 测试相关
- `chore:` 构建/工具相关

**分支策略：**
- `main` - 主分支，稳定版本
- `develop` - 开发分支
- `feature/*` - 功能分支
- `bugfix/*` - Bug 修复分支

**代码审查：**
- 所有代码合并前需要 Code Review
- 关键功能需要测试覆盖
- 遵循项目代码规范
